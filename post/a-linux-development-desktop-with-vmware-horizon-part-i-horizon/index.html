<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>A Linux Development Desktop with VMware Horizon - Part I: Horizon - Robert Guske</title><meta name="description" content="Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations."><meta property="og:title" content="A Linux Development Desktop with VMware Horizon - Part I: Horizon" />
<meta property="og:description" content="Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" /><meta property="og:image" content="https://rguske.github.io/img/avatar2.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-27T16:34:48&#43;01:00" />
<meta property="article:modified_time" content="2021-04-26T23:26:38&#43;02:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rguske.github.io/img/avatar2.png"/>

<meta name="twitter:title" content="A Linux Development Desktop with VMware Horizon - Part I: Horizon"/>
<meta name="twitter:description" content="Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations."/>
<meta name="application-name" content="Robert Guske">
<meta name="apple-mobile-web-app-title" content="Robert Guske"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" /><link rel="prev" href="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-ii-applications/" /><link rel="next" href="https://rguske.github.io/post/using-harbor-with-the-vcenter-event-broker-appliance/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.4446c9fc5d4f2707d38c9510fa2a6675dd61151cb639d003ca65a9e5ac9f5ab1.css" integrity="sha256-REbJ/F1PJwfTjJUQ&#43;ipmdd1hFRy2OdADymWp5ayfWrE="><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><meta name="google-site-verification" content="WA7hqFngJR6BpdME_dqsDyCzWf8YVaWVM6FUUyycIoI" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "A Linux Development Desktop with VMware Horizon - Part I: Horizon",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/rguske.github.io\/post\/a-linux-development-desktop-with-vmware-horizon-part-i-horizon\/"
        },"genre": "posts","keywords": "February2020, Linux, Horizon, VDI","wordcount":  2446 ,
        "url": "https:\/\/rguske.github.io\/post\/a-linux-development-desktop-with-vmware-horizon-part-i-horizon\/","datePublished": "2020-02-27T16:34:48+01:00","dateModified": "2021-04-26T23:26:38+02:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License. ¬© All rights reserved -2018","publisher": {
            "@type": "Organization",
            "name": "Robert Guske"},"author": {
                "@type": "Person",
                "name": "Robert Guske"
            },"description": "Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations."
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">('true' === 'true' && window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Robert Guske"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/avatar2.png"
        data-srcset="/img/avatar2.png, /img/avatar2.png 1.5x, /img/avatar2.png 2x"
        data-sizes="auto"
        alt="/img/avatar2.png"
        title="/img/avatar2.png" /><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Take either the red pill or the blue pill"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/post/vmware-microsites-you-should-bookmark/" title="VMware Microsites"> VMware Microsites </a><a class="menu-item" href="/about/" title="The Author"> About </a><a class="menu-item" href="/disclaimer/"> Disclaimer </a><a class="menu-item" href="https://github.com/rguske" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Robert Guske"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/avatar2.png"
        data-srcset="/img/avatar2.png, /img/avatar2.png 1.5x, /img/avatar2.png 2x"
        data-sizes="auto"
        alt="/img/avatar2.png"
        title="/img/avatar2.png" /><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Take either the red pill or the blue pill">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/post/vmware-microsites-you-should-bookmark/" title="VMware Microsites">VMware Microsites</a><a class="menu-item" href="/about/" title="The Author">About</a><a class="menu-item" href="/disclaimer/" title="">Disclaimer</a><a class="menu-item" href="https://github.com/rguske" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">A Linux Development Desktop with VMware Horizon - Part I: Horizon</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/about/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Robert Guske</a></span>&nbsp;<span class="post-category">included in <a href="/categories/linux/"><i class="far fa-folder fa-fw"></i>Linux</a>&nbsp;<a href="/categories/vdi/"><i class="far fa-folder fa-fw"></i>VDI</a>&nbsp;<a href="/categories/desktop/"><i class="far fa-folder fa-fw"></i>Desktop</a>&nbsp;<a href="/categories/vmware/"><i class="far fa-folder fa-fw"></i>VMware</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-02-27">2020-02-27</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2446 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;12 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/devdesk_part_i_cover.png"
        data-srcset="/img/devdesk_part_i_cover.png, /img/devdesk_part_i_cover.png 1.5x, /img/devdesk_part_i_cover.png 2x"
        data-sizes="auto"
        alt="/img/devdesk_part_i_cover.png"
        title="Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations." /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#the-universal-workbench">The Universal Workbench</a></li>
    <li><a href="#my-mindnode">My Mindnode</a></li>
    <li><a href="#1-setup-vmware-horizon-connection-server-v711">1. Setup VMware Horizon Connection Server (v.7.11)</a></li>
    <li><a href="#2-install-a-linux-vm">2. Install a Linux-VM</a>
      <ul>
        <li><a href="#21-select-a-linux-distribution">2.1 Select a Linux Distribution</a></li>
        <li><a href="#22-download-linux-installation-iso">2.2 Download Linux installation iso</a></li>
        <li><a href="#23-create-a-new-virtual-machine">2.3 Create a new Virtual Machine</a></li>
        <li><a href="#24-ntp-ubuntu">2.4 NTP (Ubuntu)</a></li>
        <li><a href="#25-ssh-ubuntu">2.5 SSH (Ubuntu)</a></li>
        <li><a href="#26-packages-and-module-dependencies">2.6 Packages and module dependencies</a></li>
      </ul>
    </li>
    <li><a href="#3-single-sign-on">3 Single Sign-On</a>
      <ul>
        <li><a href="#31-integrating-ubuntu-with-active-directory">3.1 Integrating Ubuntu with Active Directory</a></li>
        <li><a href="#32-integrating-centos-8-with-active-directory">3.2 Integrating CentOS 8 with Active Directory</a></li>
      </ul>
    </li>
    <li><a href="#4-install-horizon-view-agent">4 Install Horizon View Agent</a></li>
    <li><a href="#5-create-a-manual-desktop-pool">5 Create a Manual Desktop Pool</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="the-universal-workbench">The Universal Workbench</h2>
<p>I often thought about writing down my experiences on the topics of <em>Jumphosts</em>, <em>Shell-modifications</em> and <em>useful tools</em> in a series of blog posts, but I hadn¬¥t found the right moment, until I saw the following Tweet, where Alex asked his followers how they get access to a Linux system if they aren¬¥t running Linux on their workstation (locally).</p>
<center> <blockquote class="twitter-tweet" data-dnt="true"><p lang="in" dir="ltr">Ubuntu 18.04 VDI desktop</p>&mdash; Mark Brookfield (@virtualhobbit) <a href="https://twitter.com/virtualhobbit/status/1210952121488728066?ref_src=twsrc%5Etfw">December 28, 2019</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
 </center>
<p>Similar to Mark¬¥s answer, I¬¥m also using a VDI (Virtual-Desktop-Infrastructure) desktop for my purposes and I began writing this series&hellip;back in January&hellip;time passed by and due to other projects I worked on and which demanded a lot of my attention (<a href="https://www.vmweventbroker.io" target="_blank" rel="noopener noreferrer">VEBA</a> üòÅ), it took a little bit longer to publish them.</p>
<div class="details admonition success open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-check-circle fa-fw"></i>Thank You<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Big thanks to <a href="https://de.linkedin.com/in/gerrit-lehr-b00a34a9" target="_blank" rel="noopener noreferrer">Gerrit Lehr</a>, <a href="https://twitter.com/HilkoLantinga" target="_blank" rel="noopener noreferrer">Hilko Lantinga</a> and <a href="https://twitter.com/ivirtualex" target="_blank" rel="noopener noreferrer">Alex Lopez</a> for your valuable input and feedback.</div>
        </div>
    </div>
<hr>
<p>Having a suitable <em>Jumphost</em>, <em>Remotehost</em>, <em>Development-workstation</em> or however you like to call the system that you connect to, to have access to the appropriate tools and applications available, comes in very handy when you reach the limits or get stuck with your local machine.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>[Ops] Deploying an OVA (Open virtualization Appliance) which is located locally on your workstation into your remote Datacenter via VPN isn¬¥t really a good idea.</li>
<li>[Dev] I recently had to repeatedly create new versions of an OVA for testing purposes as changes were made to the code. Building the OVA takes time.</li>
</ul>
<p>And another very important aspect of having a &ldquo;Developer-friendly&rdquo; environment quickly available comes into play! Let¬¥s consider the rise of Kubernetes for example. Organizations today will perhaps reach a point, where it will be necessary to employ external developers and engineers (e.g. <a href="https://en.wikipedia.org/wiki/Site_Reliability_Engineering" target="_blank">SRE¬¥s</a>, <a href="https://en.wikipedia.org/wiki/Reliability_engineering" target="_blank">PRE¬¥s</a>) and provide a environment to them, that is on the one hand organization compliant and on the other hand offers sufficient flexibility and appropriate tools to these developers and engineers.</p>
<p>With this series of posts, I¬¥d like to demonstrate how you can build such an environment for the described use-cases on your own and what¬¥s necessary to offer it as a VDI desktop to your team or external employers. This will include the setup of a <em>VMware Horizon Connection Server (broker for client connections)</em>, the installation, configuration and preperation of the Linux distributions <span style="color:#018914">Ubuntu</span> and <span style="color:#6003B6">CentOS</span> and how you can turn them into <strong>a universal workbench for development and operations.</strong></p>
<p><strong>Please give 3 minutes of your precious time</strong> for the following recording to get an idea of what you can expect at the end of these three articles.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube-nocookie.com/embed/iWiryTFG4Mg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p><em><center>Video I: SSO and HTML5 feature in VMware Horizon</center></em></p>
<h2 id="my-mindnode">My Mindnode</h2>
<p><a href="https://github.com/rguske/rguske.github.io/blob/master/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png" target="_blank" rel="noopener noreferrer"><strong>Download</strong> on <i class='fab fa-github fa-fw'></i></a></p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png" title="/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png" data-thumbnail="/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png" data-sub-html="<h2>Figure I: Mindnode Development Desktop</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png"
            data-srcset="/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png, /img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png 1.5x, /img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/rg_022020_mindnode_post_devdesk.png" />
    </a><figcaption class="image-caption">Figure I: Mindnode Development Desktop</figcaption>
    </figure>
<h2 id="1-setup-vmware-horizon-connection-server-v711">1. Setup VMware Horizon Connection Server (v.7.11)</h2>
<p>The VMware Horizon Connection Server is the broker for your client connections which authenticates users through Windows Active Directory and directs the request to the appropriate virtual machine (<em>Figure II</em>).</p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg" title="/img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg" data-thumbnail="/img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg" data-sub-html="<h2>Figure II: VMware Horizon Client authenticating to a Connection Server</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg"
            data-srcset="/img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg, /img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg 1.5x, /img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/CapturFiles-20200218_034842.jpg" />
    </a><figcaption class="image-caption">Figure II: VMware Horizon Client authenticating to a Connection Server</figcaption>
    </figure>
<p><em>Source:</em> <a href="https://techzone.vmware.com/resource/workspace-one-and-horizon-reference-architecture#component-design-horizon-architecture" target="_blank">Digital Workspace Tech Zone - VMware Workspace ONE and VMware Horizon Reference Architecture</a></p>
<p>If all <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/horizon-installation/GUID-68621B8E-F018-4BC4-811A-5CF76B55DB2C.html#GUID-68621B8E-F018-4BC4-811A-5CF76B55DB2C" target="_blank">PREREQUISITES</a> are given (<em>Figure I: Mindnode Development Desktop</em>), the installation itself is really quick and simple.</p>
<p><strong>Short overview</strong></p>
<ul>
<li>Windows Server VM (W2k8R2 - W2k19) which is part of a MS Domain
<ul>
<li>The Connection Server cannot be installed on a Domain Controller (e.g. for a PoC or a Homelab)</li>
</ul>
</li>
<li>Download and install the Connection Server v.7.11 installer (VMware-Horizon-Connection-Server-x86_64-7.11.0.exe / ~250 MB)</li>
<li>Select the <em>View Standard Server role</em></li>
<li>Choose a User or a Group (local or AD) to authorize them for Horizon 7 administration</li>
</ul>
<p>That¬¥s it roughly! Therefore, it¬¥s not necessary for me to go into the details here and instead, I¬¥d like to refer you to the following sources:</p>
<p><strong>VMware Docs</strong></p>
<ul>
<li><em>Install Horizon Connection Server with a New Configuration</em> - <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/horizon-installation/GUID-9F93A59F-C35F-4388-B3D6-CE4F50D8BAFD.html">https://docs.vmware.com/en/VMware-Horizon-7/7.11/horizon-installation/GUID-9F93A59F-C35F-4388-B3D6-CE4F50D8BAFD.html</a></li>
</ul>
<p><strong>Post</strong> by <a href="https://twitter.com/cstalhood" target="_blank">Carl Stalhood</a></p>
<ul>
<li><em>Install Horizon 7 Standard Connection Server</em> by - <a href="https://www.carlstalhood.com/vmware-horizon-7-connection-server/">https://www.carlstalhood.com/vmware-horizon-7-connection-server/</a></li>
</ul>
<h2 id="2-install-a-linux-vm">2. Install a Linux-VM</h2>
<h3 id="21-select-a-linux-distribution">2.1 Select a Linux Distribution</h3>
<p>In this post, I¬¥ll concentrate just on <span style="color:#018914">Ubuntu 18.04 LTS</span> and <span style="color:#6003B6">CentOS 8.0</span> but in case that this is not your pick, you¬¥ll find all Linux distributions that are supported for Horizon Agent on page 14 of the official installation guide here:<a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup.pdf" target="_blank"> <em>&ldquo;Setting Up Horizon 7 for Linux Desktops&rdquo;</em></a>.</p>
<h3 id="22-download-linux-installation-iso">2.2 Download Linux installation iso</h3>
<ul>
<li><span style="color:#018914"><strong>Ubuntu 18.04 LTS:</strong> <a href="https://ubuntu.com/download/desktop/">https://ubuntu.com/download/desktop/</a></li>
<li><span style="color:#6003B6"><strong>CentOS 8.0</strong> (at this time only 8.0 is supported!): <a href="http://isoredirect.centos.org/centos/8/isos/x86_64/">http://isoredirect.centos.org/centos/8/isos/x86_64/</a></li>
</ul>
<h3 id="23-create-a-new-virtual-machine">2.3 Create a new Virtual Machine</h3>
<p>Now that your iso is ready to be mounted let¬¥s create a new Virtual Machine. Choose your distro from the list and configure your vHardware. I followed the official recommendation for <em>&ldquo;Improved video playback in a 2D desktop (<a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup.pdf" target="_blank" rel="noopener noreferrer">page 23</a>)</em>.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg" title="/img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg" data-thumbnail="/img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg" data-sub-html="<h2>Figure III: Linux Distribution &amp; vHardware Settings</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg"
            data-srcset="/img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg, /img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg 1.5x, /img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/CapturFiles-20200219_123512.jpg" />
    </a><figcaption class="image-caption">Figure III: Linux Distribution &amp; vHardware Settings</figcaption>
    </figure>
<p>For <span style="color:#6003B6">CentOS</span> I chose the &ldquo;<em>Workstation</em>&rdquo; option. Minimal installation is sufficient for <span style="color:#018914">Ubuntu</span>.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg" title="/img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg" data-thumbnail="/img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg" data-sub-html="<h2>Figure IV: Installation options CentOS 8.0 &amp; Ubuntu LTS 18.04</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg"
            data-srcset="/img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg, /img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg 1.5x, /img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/CapturFiles-20200224_093014.jpg" />
    </a><figcaption class="image-caption">Figure IV: Installation options CentOS 8.0 &amp; Ubuntu LTS 18.04</figcaption>
    </figure>
<p>Compared to CentOS, it¬¥s not possible under Ubuntu to make the system settings like e.g. the Network-settings or NTP during the initial phase of the installation. So make sure that you configure everything after Ubuntu is booted for the first time.</p>
<h3 id="24-ntp-ubuntu">2.4 NTP (Ubuntu)</h3>
<p>Proper network time synchronization is an essential part of monitoring a network and resolving issues within it!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt install ntp
systemctl status ntp
timedatectl list-timezones
timedatectl set-timezone Europe/Berlin
</code></pre></td></tr></table>
</div>
</div><p>Set your NTP server in the <code>/etc/ntp.conf</code> file. Chose an server pool closest to your location (<a href="https://www.ntppool.org/zone">https://www.ntppool.org/zone</a>) and restart the ntp.service (<code>systemctl restart ntp</code>) after you¬¥ve finished your configuration.</p>
<h3 id="25-ssh-ubuntu">2.5 SSH (Ubuntu)</h3>
<p>Activating <code>SSH</code> makes all the configurations, which will follow, a lot easier (<em>copy &amp; paste</em>) in comparison to using the VMware Remote Console. <em>OpenSSH</em> has to be installed on Ubuntu:</p>
<p><strong><span style="color:#018914">Ubuntu:</span></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt install openssh-server
</code></pre></td></tr></table>
</div>
</div><p><strong><span style="color:#6003B6">CentOS:</span></strong> <em>OpenSSH server is installed and enabled by default.</em></p>
<p>Check that the service is <span style="color:#168407"><em>Active</em></span> and running:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">systemctl status sshd.service
</code></pre></td></tr></table>
</div>
</div><h3 id="26-packages-and-module-dependencies">2.6 Packages and module dependencies</h3>
<p>We¬¥re planning to join our system into a Active Directory Domain and also want to install the VMware Horizon View Agent, which is necessary for adding our machine to a Desktop-Pool later on. Before we can continue, it¬¥s necessary to eliminate some dependencies by installing some packages upfront.</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note: The following only applies to CentOS 8.0 with Horizon Agent version 7.11<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Do not** run <code>yum update</code>!</div>
        </div>
    </div>
<p>Normally, the first step I do after setting up a fresh Linux system, is the update of every currently installed package of it (<code>apt update</code> / <code>yum update</code>). You can run the update and upgrade &ldquo;safely&rdquo; for Ubuntu but <strong>NOT</strong> for CentOS 8.0. The <em>VMware Horizon View Agent v.7.11</em> does not support <em><strong>gnome-shell version 3.3x</strong></em>. If you run the <code>sudo yum update</code> command, the gnome-shell will be updated and this leads to the following error:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">The version of gnome shell 3.32.2 isn&#39;t matched,\n
                       try to replace default version.
Don&#39;t support 8.1.1911, disable sso
</code></pre></td></tr></table>
</div>
</div><p><strong>&ldquo;Disable SSO&rdquo;</strong> isn¬¥t what we want!</p>
<p>I also tried to exclude the package update for the <a href="https://en.wikipedia.org/wiki/GNOME_Shell" target="_blank"><em>GNOME Shell</em></a> by excluding it as well as <a href="https://en.wikipedia.org/wiki/Mutter_(software)" target="_blank"><em>Mutter</em></a> from the yum.conf file&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo vim /etc/yum.conf

<span class="nv">exclude</span><span class="o">=</span>gnome* mutter*
</code></pre></td></tr></table>
</div>
</div><p>&hellip;but this will cause the system to boot with a black-screen. I got the internal feedback, that we¬¥ll support CentOS 8.1 (gnome-shell 3.3x) with Horizon v.7.12.</p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>[2020-03-17] Update<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">VMware Horizon 7.12 with CentOS 8.1 support released: <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.12/rn/horizon-712-view-release-notes.html" target="_blank" rel="noopener noreferrer">Release Notes</a></div>
        </div>
    </div>
<p>As already mentioned earlier, normally I update my freshly installed system immediately after the first boot. Let¬¥s do this now!</p>
<p><strong><span style="color:#018914">Ubuntu:</span></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt -y update <span class="o">&amp;&amp;</span> sudo apt -y upgrade <span class="o">&amp;&amp;</span> sudo reboot
</code></pre></td></tr></table>
</div>
</div><p><strong><span style="color:#6003B6">CentOS:</span></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo yum update
</code></pre></td></tr></table>
</div>
</div><p><strong>Now</strong> that our system has a current state, we will install the needed packages which are necessary to proceed further.</p>
<p><strong><span style="color:#018914">Ubuntu:</span></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt -y install open-vm-tools-desktop vim curl git build-essential realmd python python-dbus python-gobject
</code></pre></td></tr></table>
</div>
</div><p><strong><span style="color:#6003B6">CentOS:</span></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo dnf -y install sssd oddjob oddjob-mkhomedir adcli samba-common-tools
</code></pre></td></tr></table>
</div>
</div><h2 id="3-single-sign-on">3 Single Sign-On</h2>
<p><em>Source: <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup/GUID-4532309E-F219-4FEC-ADC4-B62B5E67BC8F.html" target="_blank" rel="noopener noreferrer">VMware Horizon 7: Setting Up Single Sign-On</a></em></p>
<p>The Horizon Single Sign-On feature gives us the great ability to connect to our Linux system via the Horizon View Client (<em>Video I &amp; Figure II</em>) with an, on the Desktop-Pool level, entitled Active Directory user. This also includes the creation of users home directory if the user logs in for the first time. We have to integrate our Desktop with an Active Directory first to make use of SSO.</p>
<h3 id="31-integrating-ubuntu-with-active-directory">3.1 Integrating Ubuntu with Active Directory</h3>
<p><em>Source: <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup/GUID-66FC1A47-616D-4240-A874-2FA07F0C6EF2.html" target="_blank" rel="noopener noreferrer">VMware Horizon 7: PowerBroker Identity Services Open (PBISO)</a></em></p>
<p><strong><span style="color:#018914">Ubuntu:</span></strong></p>
<p>Pbis-open Releases: <a href="https://github.com/BeyondTrust/pbis-open/releases">https://github.com/BeyondTrust/pbis-open/releases</a></p>
<p><strong>Download and installation:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">wget https://github.com/BeyondTrust/pbis-open/releases/download/9.1.0/pbis-open-9.1.0.551.linux.x86_64.deb.sh
chmod +x pbis-open-9.1.0.551.linux.x86_64.deb.sh
sudo ./pbis-open-9.1.0.551.linux.x86_64.deb.sh
</code></pre></td></tr></table>
</div>
</div><p><strong>Domain join:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sudo domainjoin-cli --loglevel info join jarvis.lab admin@jarvis.lab

Joining to AD Domain:   jarvis.lab
With Computer DNS Name: devdesk-ubuntu.jarvis.lab
admin@JARVIS.LABs password:
Warning: System restart required
Your system has been configured to authenticate to Active Directory for the first time.  It is recommended that you restart your system to ensure that all applications recognize the new settings.
SUCCESS
</code></pre></td></tr></table>
</div>
</div><p>If you get the following error during the domain join&hellip;</p>
<div class="details admonition failure open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-times-circle fa-fw"></i>Error<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">DNS_ERROR_BAD_PACKET [code 0x0000251e] A bad packet was received from a DNS server. Potentially the requested address does not exist.</div>
        </div>
    </div>
<p>&hellip;then the following applies: <em>&ldquo;It&rsquo;s not DNS&rdquo;</em>&hellip;<em>&ldquo;There&rsquo;s no way it&rsquo;s DNS&rdquo;</em>&hellip;<strong>It was DNS!</strong>. Make sure DNS is set up properly.</p>
<p><strong>Default configuration for domain users:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sudo /opt/pbis/bin/config UserDomainPrefix jarvis
sudo /opt/pbis/bin/config AssumeDefaultDomain true
sudo /opt/pbis/bin/config LoginShellTemplate /bin/bash
sudo /opt/pbis/bin/config HomeDirTemplate %H/%U
</code></pre></td></tr></table>
</div>
</div><p>Edit the <code>/etc/pam.d/common-session</code> file and <code>replace</code> the line <code>session optional pam_lsass.so</code> with <code>session [success=ok default=ignore] pam_lsass.so</code>, save and quite (<code>wq</code>) and reboot the system.</p>
<p><strong>Note:</strong> Updating the Horizon Agent will require that this setting must be performed again.</p>
<h3 id="32-integrating-centos-8-with-active-directory">3.2 Integrating CentOS 8 with Active Directory</h3>
<p><em>Source: <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup/GUID-93F4CA16-5F47-47BE-B28C-E8A7901E0391.html" target="_blank" rel="noopener noreferrer">VMware Horizon 7: Use the Realmd Join Solution for RHEL/CentOS 8.0</a></em></p>
<p>To have the ability to connect with an AD user to our desktop, we have to join an Active Directory domain. <code>realmd</code> will be the tool of our choice to join an Active Directory domain. It¬¥s installed on CentOS by default.</p>
<p><strong><span style="color:#6003B6">CentOS:</span></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo realm discover -vvv jarvis.lab
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"> * Resolving: _ldap._tcp.jarvis.lab
 * Performing LDAP DSE lookup on: 10.10.13.10
 * Successfully discovered: jarvis.lab
jarvis.lab
  type: kerberos
  realm-name: JARVIS.LAB
  domain-name: jarvis.lab
  configured: no
  server-software: active-directory
  client-software: sssd
  required-package: oddjob
  required-package: oddjob-mkhomedir
  required-package: sssd
  required-package: adcli
  required-package: samba-common-tools
</code></pre></td></tr></table>
</div>
</div><p>That looks g00d! So the next step is joining the discovered realm. Execute <code>sudo realm join -v -U admin@JARVIS.LAB JARVIS.LAB</code> and wait until your terminal shows you the result. The <code>-v</code> option will give you a verbose output.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo realm join -v -U admin@JARVIS.LAB JARVIS.LAB
</code></pre></td></tr></table>
</div>
</div><p>Last to-do at this point is to edit the <code>/etc/sssd/sssd.conf</code>. Add <code>ad_gpo_map_interactive = +gdm-vmwcred</code>, <code>simple_allow_groups = &quot;Your-AD-User-Group&quot;</code> under the [domain/domain name] section and set the value for <code>use_fully_qualified_names</code> to <code>= False</code>.</p>
<p>Example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo vim /etc/sssd/sssd.conf

<span class="o">[</span>sssd<span class="o">]</span>
<span class="nv">domains</span> <span class="o">=</span> jarvis.lab
<span class="nv">config_file_version</span> <span class="o">=</span> <span class="m">2</span>
<span class="nv">services</span> <span class="o">=</span> nss, pam

<span class="o">[</span>domain/jarvis.lab<span class="o">]</span>
<span class="nv">ad_domain</span> <span class="o">=</span> jarvis.lab
<span class="nv">krb5_realm</span> <span class="o">=</span> JARVIS.LAB
<span class="nv">realmd_tags</span> <span class="o">=</span> manages-system joined-with-adcli
<span class="nv">cache_credentials</span> <span class="o">=</span> True
<span class="nv">id_provider</span> <span class="o">=</span> ad
<span class="nv">krb5_store_password_if_offline</span> <span class="o">=</span> True
<span class="nv">default_shell</span> <span class="o">=</span> /bin/bash
<span class="nv">ldap_id_mapping</span> <span class="o">=</span> True
<span class="nv">use_fully_qualified_names</span> <span class="o">=</span> False
<span class="nv">fallback_homedir</span> <span class="o">=</span> /home/%d/%u
<span class="nv">access_provider</span> <span class="o">=</span> ad
<span class="nv">ad_gpo_map_interactive</span> <span class="o">=</span> +gdm-vmwcred
<span class="nv">simple_allow_groups</span> <span class="o">=</span> labadmins@JARVIS.LAB
</code></pre></td></tr></table>
</div>
</div><p>We are going to use <em>Gnome Classic</em> for the SSO login for CentOS 8.0. Remove all the desktop startup files from the <code>/usr/share/xsessions</code> directory, except the one for <em>Gnome Classic</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">cd</span> /usr/share/xsessions/
ls -rtl
-rw-r--r--. <span class="m">1</span> root root <span class="m">8471</span> May <span class="m">15</span>  <span class="m">2019</span> gnome-custom-session.desktop
-rw-r--r--. <span class="m">1</span> root root <span class="m">1303</span> May <span class="m">15</span>  <span class="m">2019</span> gnome.desktop
-rw-r--r--. <span class="m">1</span> root root <span class="m">1303</span> May <span class="m">15</span>  <span class="m">2019</span> gnome-xorg.desktop
-rw-r--r--. <span class="m">1</span> root root <span class="m">1394</span> May <span class="m">17</span>  <span class="m">2019</span> gnome-classic.desktop
sudo mkdir backup
sudo mv *.desktop backup/
sudo mv backup/gnome-classic.desktop ./
</code></pre></td></tr></table>
</div>
</div><p><strong>Note:</strong> Updating the Horizon Agent will require that this setting must be performed again.</p>
<p><strong>Reboot</strong> the system.</p>
<h2 id="4-install-horizon-view-agent">4 Install Horizon View Agent</h2>
<p>As a next step we¬¥re going to install the VMware View Agent which must be installed on virtual machines that are managed by vCenter Server so that View Connection Server can communicate with them.</p>
<p><strong>Download:</strong> <a href="https://www.vmware.com/go/download-horizon">https://www.vmware.com/go/download-horizon</a></p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Tip<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">I¬¥ve downloaded the Agent locally first and copied it then via <code>scp</code> into my VM(s).</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">scp /Users/rguske/Downloads/VMware-horizonagent-linux-x86_64-7.11.0-15238356.tar.gz jarvis@devdesk-centos:/home/jarvis/Downloads
</code></pre></td></tr></table>
</div>
</div><p>Unpack the tarball, go into the unpacked directory and execute the <code>install_viewagent.sh</code> script.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">tar -zxvf VMware-horizonagent-linux-x86_64-7.11.0-15238356.tar.gz
<span class="nb">cd</span> VMware-horizonagent-linux-x86_64-7.11.0-15238356/
~/Downloads/VMware-horizonagent-linux-x86_64-7.11.0-15238356$ ./install_viewagent.sh -A yes
</code></pre></td></tr></table>
</div>
</div><ul>
<li><em>Regarding the used command options and arguments</em> - <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup/GUID-09A3F97C-47FE-4ABF-B68C-E42AE26632CC.html#GUID-09A3F97C-47FE-4ABF-B68C-E42AE26632CC">https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup/GUID-09A3F97C-47FE-4ABF-B68C-E42AE26632CC.html#GUID-09A3F97C-47FE-4ABF-B68C-E42AE26632CC</a></li>
</ul>
<p>Now set the correct <em>SSO Desktop Type</em> for the View Agent (see <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup.pdf" target="_blank" rel="noopener noreferrer">page 18 and 107</a>). Run <code>sudo vim /etc/vmware/viewagent-custom.conf</code> and uncomment the necessary line for your desktop environment.</p>
<ul>
<li><span style="color:#018914"><strong>Ubuntu 18.04</strong></span> = <em>SSODesktopType=UseGnomeUbuntu</em></li>
<li><span style="color:#6003B6"><strong>CentOS</strong></span> = <em>SSODesktopType=UseGnomeClassic</em></li>
</ul>
<p>On the way down through the <em>viewagent-custom.conf</em> you came by a point where you can define a subnet for the View-Agent. If you like to install Docker on your desktop, as I would assume, you have to uncomment the example and replace the CIDR with yours.</p>
<p><strong>In my case:</strong> <em>Subnet=10.10.13.0/26</em></p>
<p>Otherwise you won¬¥t be able to connect to your desktop anymore after installing Docker. Save and exit the file with <code>:wq</code>.</p>
<h2 id="5-create-a-manual-desktop-pool">5 Create a Manual Desktop Pool</h2>
<p>Now that the work on the prerequisites for adding a VM to a Horizon Pool is complete, it¬¥s time to setup a &ldquo;<em>Manual Desktop Pool</em>&rdquo; for our Desktop. Creating a <em>Manual Desktop Pool</em> is pretty straight forward and well described in VMware¬¥s official documentation.</p>
<p><em>Source: <a href="https://docs.vmware.com/en/VMware-Horizon-7/7.11/linux-desktops-setup/GUID-0E3E3C7F-620B-496F-8C20-BAE6F93B817C.html" target="_blank">Create a Manual Desktop Pool for Linux</a></em></p>
<p><strong>Mandatory settings are:</strong></p>
<ul>
<li><strong>Default display protocol:</strong> VMware Blast</li>
<li><strong>Allow users to choose protocol:</strong> No</li>
<li><strong>3D Renderer:</strong> Manage using vSphere Client for 2D or vDGA desktop and NVIDIA GRID vGPU for vGPU desktop</li>
</ul>
<p>By the end, it should look similar to what you can see on <em>Figure V</em>.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg" title="/img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg" data-thumbnail="/img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg" data-sub-html="<h2>Figure V: Manual desktop pool(s)</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg"
            data-srcset="/img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg, /img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg 1.5x, /img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/CapturFiles-20200204_101435.jpg" />
    </a><figcaption class="image-caption">Figure V: Manual desktop pool(s)</figcaption>
    </figure>
<p>Since you¬¥ve added the Linux-VM to your new desktop pool, it¬¥ll appear under <em>Machines</em> on the left site. This section will give you a quick overview with some helpful details, like the status and version of the View Agent as well as the DNS name of your system for example. BTW! Regarding DNS&hellip;avoid mistakes like the ones I did&hellip;üòê&hellip;<em>Figure VI</em>.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg" title="/img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg" data-thumbnail="/img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg" data-sub-html="<h2>Figure VI: DNS Name = Shortname</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg"
            data-srcset="/img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg, /img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg 1.5x, /img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/CapturFiles-20200212_103007.jpg" />
    </a><figcaption class="image-caption">Figure VI: DNS Name = Shortname</figcaption>
    </figure>
<p>Let¬¥s bring this into the correct form:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo hostnamectl set-hostname devdesk-ubuntu.jarvis.lab
</code></pre></td></tr></table>
</div>
</div><p>Doublecheck if the changes got applied:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">hostname -f
</code></pre></td></tr></table>
</div>
</div><p>Way better! üëá</p>
<figure class="center"><a class="lightgallery" href="/img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg" title="/img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg" data-thumbnail="/img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg" data-sub-html="<h2>Figure VII: DNS Name = FQDN</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg"
            data-srcset="/img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg, /img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg 1.5x, /img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/201912_development_desktop/CapturFiles-20200204_103350.jpg" />
    </a><figcaption class="image-caption">Figure VII: DNS Name = FQDN</figcaption>
    </figure>
<p>You should now be able to connect to your Desktop-Pool via the <em><a href="https://my.vmware.com/en/web/vmware/info/slug/desktop_end_user_computing/vmware_horizon_clients/5_0" target="_blank" rel="noopener noreferrer">Horizon Client</a></em></a>.</p>
<hr>
<p><strong><center>Thanks for reading.</center></strong></p>
<hr>
<p><strong>Change Log:</strong></p>
<ul>
<li>[2020-03-18]: Added VMware Horizon 7.12 announcement (CentOS 8.1 support)</li>
<li>[2020-03-18]: Updated CentOS 8.0 &amp; Horizon Agent 7.11 section; Updated Mindmap</li>
</ul></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-04-26&nbsp;<a class="git-hash" href="https://github.com/rguske/commit/0319acd558942a83319f4b63c836dd5ad1f214c3" target="_blank" rel="noopener noreferrer" title="commit by Robert Guske(rguske@vmware.com) 0319acd558942a83319f4b63c836dd5ad1f214c3: added a post description to every single post as well as website image for twitter">
                                    <i class="fas fa-hashtag fa-fw"></i>0319acd</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/index.md" target="_blank" rel="noopener noreferrer">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon" data-via="vmw_rguske" data-hashtags="February2020,Linux,Horizon,VDI"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Share on Xing" data-sharer="xing" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon"><i class="fab fa-xing fa-fw"></i></a><a href="javascript:void(0);" title="Share on Blogger" data-sharer="blogger" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon" data-description="Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations."><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon"><i class="fab fa-evernote fa-fw"></i></a><a href="javascript:void(0);" title="Share on Skype" data-sharer="skype" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon"><i class="fab fa-skype fa-fw"></i></a><a href="javascript:void(0);" title="Share on Trello" data-sharer="trello" data-url="https://rguske.github.io/post/a-linux-development-desktop-with-vmware-horizon-part-i-horizon/" data-title="A Linux Development Desktop with VMware Horizon - Part I: Horizon" data-description="Part I - A guide how to setup a VMware Horizon Connection Server, the installation, configuration and preperation of the Linux distributions Ubuntu and CentOS and how you can turn them into a universal workbench for development and operations."><i class="fab fa-trello fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/february2020/">February2020</a>,&nbsp;<a href="/tags/linux/">Linux</a>,&nbsp;<a href="/tags/horizon/">Horizon</a>,&nbsp;<a href="/tags/vdi/">VDI</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/post/a-linux-development-desktop-with-vmware-horizon-part-ii-applications/" class="prev" rel="prev" title="A Linux Development Desktop with VMware Horizon - Part II: Applications "><i class="fas fa-angle-left fa-fw"></i>A Linux Development Desktop with VMware Horizon - Part II: Applications </a>
            <a href="/post/using-harbor-with-the-vcenter-event-broker-appliance/" class="next" rel="next" title="Using Harbor with the VMware Event Broker Appliance">Using Harbor with the VMware Event Broker Appliance<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.82.0">Hugo</a> | Theme - <a href="https://github.com/sunt-programator/CodeIT" target="_blank" rel="noopener noreferrer" title="CodeIT 0.2.10"><i class="fas fa-laptop-code fa-fw"></i> CodeIT</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/about/" target="_blank" rel="noopener noreferrer">Robert Guske</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":80},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"rguske/my-gitalk"}},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"id-1":"   rguske.github.io","id-2":"   rguske.github.io"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":0,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.47a1ff73dc443ed4a9f13e3134f6058e8c6d21248b35d03e7d64f56345190c3e.js" integrity="sha256-R6H/c9xEPtSp8T4xNPYFjoxtISSLNdA&#43;fWT1Y0UZDD4="></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-122353302-1', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-122353302-1" async></script></body>
</html>
