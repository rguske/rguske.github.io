<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Monitoring the VMware Event Broker Appliance with vRealize Operations Manager - Robert Guske</title>
        <meta name="Description" content="rguske.github.io is a personal website which provides informational &amp; detailed content, based on Robert GuskeÂ´s gained experiences with solutions by VMware (primarily)."><meta property="og:title" content="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager" />
<meta property="og:description" content="Since the VMware Event Broker Appliance (VEBA) is reaching more and more folks out there and the interest is growing steadily, it is important to validate the integration with other solutions (preferably VMware). At least that&rsquo;s what I thought ðŸ˜‰.
Monitoring in terms of utilization and performance captured my interest. So, how can I monitor not only the appliance (virtual machine) but also the Kubernetes components like the Control Plane (Master), the Node(s) as well as the Pods?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" />
<meta property="article:published_time" content="2020-05-12T23:59:50+02:00" />
<meta property="article:modified_time" content="2020-05-13T00:06:17+02:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager"/>
<meta name="twitter:description" content="Since the VMware Event Broker Appliance (VEBA) is reaching more and more folks out there and the interest is growing steadily, it is important to validate the integration with other solutions (preferably VMware). At least that&rsquo;s what I thought ðŸ˜‰.
Monitoring in terms of utilization and performance captured my interest. So, how can I monitor not only the appliance (virtual machine) but also the Kubernetes components like the Control Plane (Master), the Node(s) as well as the Pods?"/>
<meta name="application-name" content="Robert Guske">
<meta name="apple-mobile-web-app-title" content="Robert Guske"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" /><link rel="prev" href="https://rguske.github.io/post/tanzu-kubernetes-grid-integrated-edition-management-console-1-7/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Monitoring the VMware Event Broker Appliance with vRealize Operations Manager",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/rguske.github.io\/post\/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager\/"
        },"image": {
                "@type": "ImageObject",
                "url": "https:\/\/rguske.github.io\/cover.png",
                "width":  800 ,
                "height":  600 
            },"genre": "posts","keywords": "May2020, VEBA, Monitoring, vRealize Operations Manager, Dashboard","wordcount":  1740 ,
        "url": "https:\/\/rguske.github.io\/post\/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager\/","datePublished": "2020-05-12T23:59:50+02:00","dateModified": "2020-05-13T00:06:17+02:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License. Â© All rights reserved -2018","publisher": {
                "@type": "Organization",
                "name": "Robert Guske",
                "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/rguske.github.io\/logo.png",
                "width":  127 ,
                "height":  40 
                }
            },"author": {
                "@type": "Person",
                "name": "Robert Guske"
            },"description": ""
    }
    </script></head>
    <body><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Robert Guske"><img
        class="lazyload logo"
        src="/svg/loading/small.min.svg"
        data-src="/img/avatar.png"
        data-srcset="/img/avatar.png, /img/avatar.png 1.5x, /img/avatar.png 2x"
        data-sizes="auto"
        alt="Robert Guske"
        title="Robert Guske" />Robert Guske</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Read me"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/post/vmware-microsites-you-should-bookmark/" title="VMware Microsites"> VMware Microsites </a><a class="menu-item" href="/about/" title="The Author"> About </a><a class="menu-item" href="/disclaimer/"> Disclaimer </a><a class="menu-item" href="https://github.com/rguske" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Robert Guske"><img
        class="lazyload logo"
        src="/svg/loading/small.min.svg"
        data-src="/img/avatar.png"
        data-srcset="/img/avatar.png, /img/avatar.png 1.5x, /img/avatar.png 2x"
        data-sizes="auto"
        alt="Robert Guske"
        title="Robert Guske" />Robert Guske</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Read me">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/post/vmware-microsites-you-should-bookmark/" title="VMware Microsites">VMware Microsites</a><a class="menu-item" href="/about/" title="The Author">About</a><a class="menu-item" href="/disclaimer/" title="">Disclaimer</a><a class="menu-item" href="https://github.com/rguske" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Monitoring the VMware Event Broker Appliance with vRealize Operations Manager</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/about/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Robert Guske</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i><time datetime=2020-05-12>2020-05-12</time>&nbsp;
                <i class="fas fa-pencil-alt fa-fw"></i>about 1740 words&nbsp;
                <i class="far fa-clock fa-fw"></i>9 min&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading/normal.min.svg"
        data-src="/img/vrops_veba_cover.jpg"
        data-srcset="/img/vrops_veba_cover.jpg, /img/vrops_veba_cover.jpg 1.5x, /img/vrops_veba_cover.jpg 2x"
        data-sizes="auto"
        alt="/img/vrops_veba_cover.jpg"
        title="/img/vrops_veba_cover.jpg" /></div><div class="details toc" id="toc-static">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#leveraging-google-cadvisor">Leveraging Google cAdvisor</a>
      <ul>
        <li><a href="#enabling-ssh-on-veba">Enabling SSH on VEBA</a></li>
        <li><a href="#deploy-the-cadvisor-as-a-kubernetes-daemonset">Deploy the cAdvisor as a Kubernetes DaemonSet</a>
          <ul>
            <li><a href="#environment-with-internet-access">Environment with internet access</a></li>
            <li><a href="#environment-without-internet-access">Environment without internet access</a></li>
          </ul>
        </li>
        <li><a href="#validate-the-cadvisor-deployment">Validate the cAdvisor deployment</a></li>
      </ul>
    </li>
    <li><a href="#a-dashboard-to-monitor-the-vmware-event-broker-appliance">A Dashboard to monitor the VMware Event Broker Appliance</a>
      <ul>
        <li><a href="#step-1-import-vrops-management-pack-for-container-monitoring">Step 1. Import vROps Management Pack for Container Monitoring</a></li>
        <li><a href="#step-2-preparations-for-the-dashboard">Step 2. Preparations for the dashboard</a>
          <ul>
            <li><a href="#veba-node-utilization-metric-configuration">VEBA Node Utilization Metric Configuration</a></li>
            <li><a href="#veba-openfaas-fn-namespace-custom-group">VEBA openfaas-fn namespace Custom Group</a></li>
          </ul>
        </li>
        <li><a href="#step-3-import-the-dashboard-and-its-views">Step 3. Import the Dashboard and it&rsquo;s Views</a>
          <ul>
            <li><a href="#the-dashboard-is-available-for-download-on-vmware-codehttpscodevmwarecomsamplesid7241">The Dashboard is available for download on <a href="https://code.vmware.com/samples?id=7241">VMware {code}</a></a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Since the <a href="https://vmweventbroker.io" target="_blank" rel="noopener noreffer">VMware Event Broker Appliance (VEBA)</a> is reaching more and more folks out there and the interest is growing steadily, it is important to validate the integration with other solutions (preferably VMware). At least that&rsquo;s what I thought ðŸ˜‰.</p>
<p>Monitoring in terms of utilization and performance captured my interest. So, how can I monitor not only the appliance (virtual machine) but also the Kubernetes components like the Control Plane (Master), the Node(s) as well as the Pods? Furthermore! Not only the workload is of interest, but also the dependencies of the individual components to each other are interesting. Beyond that and because I&rsquo;m just getting started, I would also like to have the ability to generate alarms if a desired state is no longer fulfilled.</p>
<p><a href="https://www.vmware.com/products/vrealize-operations.html" target="_blank" rel="noopener noreffer">VMware&rsquo;s vRealize Operations Manager (vROps)</a> and it&rsquo;s Management Pack for Container Monitoring helped me quickly with my needs. Let me demonstrate you how we can prepare VEBA to send the desired data (metrics) to vROPs and how we import a custom dashboard that provides you with plenty of interesting and useful information.</p>
<h2 id="leveraging-google-cadvisor">Leveraging Google cAdvisor</h2>
<p><i class='fab fa-github fa-fw'></i> Repository: <a href="https://github.com/google/cadvisor">https://github.com/google/cadvisor</a></p>
<p>cAdvisor (Container Advisor) will be the component which we will make use of to get resource usage and performance data provided for vROps. It is super easy to deploy and you will see first results quickly. Let me show you how.</p>
<p>I&rsquo;m going to start a <a href="https://hub.docker.com/r/vmwarecna/nginx/" target="_blank" rel="noopener noreffer">nginx</a> container from which we will grap the data from after deploying cAdvisor.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run --name vmware-nginx -p 8181:80 vmwarecna/nginx
</code></pre></td></tr></table>
</div>
</div><p>The nginx webserver container is running and listining on port 8181 for HTTP requests. Now let&rsquo;s deploy cAdvisor in it&rsquo;s <a href="https://github.com/google/cadvisor/releases" target="_blank" rel="noopener noreffer">latest version</a> also as a docker container (for now).</p>
<p>Export the desired version as an environment variable. We will use this variable (<code>$VERSION</code>) for the container deployment.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nv">VERSION</span><span class="o">=</span>v0.35.0
</code></pre></td></tr></table>
</div>
</div><p>The following shows how the container deployment looks like and important for this example is the usage of the <code>docker</code> option <code>--publish=8080:8080</code> which will expose the port through which we can reach the cAdvisor website.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo docker run <span class="se">\
</span><span class="se"></span>  --volume<span class="o">=</span>/:/rootfs:ro <span class="se">\
</span><span class="se"></span>  --volume<span class="o">=</span>/var/run:/var/run:ro <span class="se">\
</span><span class="se"></span>  --volume<span class="o">=</span>/sys:/sys:ro <span class="se">\
</span><span class="se"></span>  --volume<span class="o">=</span>/var/lib/docker/:/var/lib/docker:ro <span class="se">\
</span><span class="se"></span>  --volume<span class="o">=</span>/dev/disk/:/dev/disk:ro <span class="se">\
</span><span class="se"></span>  --publish<span class="o">=</span>8080:8080 <span class="se">\
</span><span class="se"></span>  --detach<span class="o">=</span><span class="nb">true</span> <span class="se">\
</span><span class="se"></span>  --name<span class="o">=</span>cadvisor <span class="se">\
</span><span class="se"></span>  gcr.io/google-containers/cadvisor:<span class="nv">$VERSION</span>
</code></pre></td></tr></table>
</div>
</div><p><code>docker ps</code> will show us if both containers are up and running as well as if they are listening on the specified ports:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">CONTAINER ID        IMAGE                                       COMMAND                  CREATED             STATUS                      PORTS                           NAMES
ff0d3fad427d        gcr.io/google-containers/cadvisor:v0.35.0   <span class="s2">&#34;/usr/bin/cadvisor -â€¦&#34;</span>   <span class="m">3</span> minutes ago       Up <span class="m">3</span> minutes <span class="o">(</span>healthy<span class="o">)</span>      0.0.0.0:8080-&gt;8080/tcp          cadvisor
48da3118416f        vmwarecna/nginx                             <span class="s2">&#34;nginx -g &#39;daemon ofâ€¦&#34;</span>   <span class="m">6</span> minutes ago       Up <span class="m">6</span> minutes                443/tcp, 0.0.0.0:8181-&gt;80/tcp   vmware-nginx
</code></pre></td></tr></table>
</div>
</div><p>Both are up and we will reach the cAdvisor page via <code>localhost:8080</code>. Navigate to the container, in my case the nginx webserver, which performance data we want to see. Here we go:</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg" data-sub-html="<h2>Figure I: cAdvisor provides performance data</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg, /img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200511_103540.jpg" width="700" />
    </a><figcaption class="image-caption">Figure I: cAdvisor provides performance data</figcaption>
    </figure>
<p>This is the kind of data that vROps can put into a good looking shape. Now let&rsquo;s move on to deploy cAdvisor on VEBA.</p>
<h3 id="enabling-ssh-on-veba">Enabling SSH on VEBA</h3>
<p><code>SSH</code> is disabled by deafult on VEBA. To enable <code>ssh</code>, open a virtual machine console session (Web or VMware Remote Console) through the vSphere Client and login with your configured root credentials. Start the <code>sshd</code> daemon by executing <code>systemctl start sshd</code> and validate if it&rsquo;s running properly with <code>systemctl status sshd</code>.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg" data-sub-html="<h2>Figure II: PhotonOS - start sshd daemon</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg, /img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200511_114121.jpg" width="700" />
    </a><figcaption class="image-caption">Figure II: PhotonOS - start sshd daemon</figcaption>
    </figure>
<h3 id="deploy-the-cadvisor-as-a-kubernetes-daemonset">Deploy the cAdvisor as a Kubernetes DaemonSet</h3>
<h4 id="environment-with-internet-access">Environment with internet access</h4>
<p>Now it&rsquo;s on the time to deploy the cAdvisor as a Kubernetes <code>DaemonSet</code> onto VEBA. I&rsquo;ve used the yaml specifications from the cAdvisor <i class='fab fa-github fa-fw'></i> repository which are located in <code>/deploy/kubernetes/base</code> and modified them a bit for my needs. We will have three files at the end, because we are using <a href="https://github.com/kubernetes-sigs/kustomize" target="_blank" rel="noopener noreffer">kustomize</a> in order to create and deploy the namespace and the daemonset for cAdvisor.</p>
<p>Establish a <code>ssh</code> connection to your VEBA appliance and change into the <code>/tmp</code> directory. I have set up a repository on Github where I&rsquo;ve stored the necessary files for the deployment. From here (<code>/tmp</code>) we will clone the repository and deploy the daemonset to the Kubernetes Master subsequently. Run <code>git clone https://github.com/rguske/monitoring-veba.git &amp;&amp; kubectl apply -k monitoring-veba/</code>.</p>
<h4 id="environment-without-internet-access">Environment without internet access</h4>
<p>For air-gapped environments, three simple steps are neccessary:</p>
<ol>
<li>create a new directory in <code>/tmp</code> -&gt; e.g. <code>mkdir /tmp/monitoring-veba</code></li>
<li>create the following three specification files inside the newly created directory:</li>
</ol>
<p><code>vim kustomization.yaml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="k">apiVersion</span><span class="p">:</span><span class="w"> </span>kustomize.config.k8s.io/v1beta1<span class="w">
</span><span class="w"></span><span class="k">kind</span><span class="p">:</span><span class="w"> </span>Kustomization<span class="w">
</span><span class="w"></span><span class="k">namespace</span><span class="p">:</span><span class="w"> </span>vrops<span class="w">
</span><span class="w"></span><span class="k">commonLabels</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">app</span><span class="p">:</span><span class="w"> </span>vrops-cadvisor<span class="w">
</span><span class="w"></span><span class="k">resources</span><span class="p">:</span><span class="w">
</span><span class="w"></span>- daemonset.yaml<span class="w">
</span><span class="w"></span>- namespace.yaml<span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><code>vim namespace.yaml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="k">apiVersion</span><span class="p">:</span><span class="w"> </span>v1<span class="w">
</span><span class="w"></span><span class="k">kind</span><span class="p">:</span><span class="w"> </span>Namespace<span class="w">
</span><span class="w"></span><span class="k">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">name</span><span class="p">:</span><span class="w"> </span>vrops<span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><code>vim daemonset.yaml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="k">apiVersion</span><span class="p">:</span><span class="w"> </span>apps/v1<span class="w">
</span><span class="w"></span><span class="k">kind</span><span class="p">:</span><span class="w"> </span>DaemonSet<span class="w">
</span><span class="w"></span><span class="k">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">name</span><span class="p">:</span><span class="w"> </span>cadvisor<span class="w">
</span><span class="w">  </span><span class="k">namespace</span><span class="p">:</span><span class="w"> </span>vrops<span class="w">
</span><span class="w"></span><span class="k">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">selector</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="k">matchLabels</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="k">name</span><span class="p">:</span><span class="w"> </span>cadvisor<span class="w">
</span><span class="w">  </span><span class="k">template</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="k">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="k">labels</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="k">name</span><span class="p">:</span><span class="w"> </span>cadvisor<span class="w">
</span><span class="w">    </span><span class="k">spec</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="k">containers</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>cadvisor<span class="w">
</span><span class="w">        </span><span class="k">image</span><span class="p">:</span><span class="w"> </span>k8s.gcr.io/cadvisor<span class="p">:</span>v0<span class="m">.35.0</span><span class="w">
</span><span class="w">        </span><span class="k">resources</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="k">requests</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="k">memory</span><span class="p">:</span><span class="w"> </span>200Mi<span class="w">
</span><span class="w">            </span><span class="k">cpu</span><span class="p">:</span><span class="w"> </span>150m<span class="w">
</span><span class="w">          </span><span class="k">limits</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="k">memory</span><span class="p">:</span><span class="w"> </span>2000Mi<span class="w">
</span><span class="w">            </span><span class="k">cpu</span><span class="p">:</span><span class="w"> </span>300m<span class="w">
</span><span class="w">        </span><span class="k">volumeMounts</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>rootfs<span class="w">
</span><span class="w">          </span><span class="k">mountPath</span><span class="p">:</span><span class="w"> </span>/rootfs<span class="w">
</span><span class="w">          </span><span class="k">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">        </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>var-run<span class="w">
</span><span class="w">          </span><span class="k">mountPath</span><span class="p">:</span><span class="w"> </span>/var/run<span class="w">
</span><span class="w">          </span><span class="k">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">        </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>sys<span class="w">
</span><span class="w">          </span><span class="k">mountPath</span><span class="p">:</span><span class="w"> </span>/sys<span class="w">
</span><span class="w">          </span><span class="k">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">        </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>docker<span class="w">
</span><span class="w">          </span><span class="k">mountPath</span><span class="p">:</span><span class="w"> </span>/var/lib/docker<span class="w">
</span><span class="w">          </span><span class="k">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">        </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>disk<span class="w">
</span><span class="w">          </span><span class="k">mountPath</span><span class="p">:</span><span class="w"> </span>/dev/disk<span class="w">
</span><span class="w">          </span><span class="k">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">        </span><span class="k">ports</span><span class="p">:</span><span class="w">
</span><span class="w">          </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>http<span class="w">
</span><span class="w">            </span><span class="k">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">31194</span><span class="w">
</span><span class="w">            </span><span class="k">hostPort</span><span class="p">:</span><span class="w"> </span><span class="m">31194</span><span class="w">
</span><span class="w">            </span><span class="k">protocol</span><span class="p">:</span><span class="w"> </span>TCP<span class="w">
</span><span class="w">        </span><span class="k">securityContext</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="k">capabilities</span><span class="p">:</span><span class="w">
</span><span class="w">              </span><span class="k">drop</span><span class="p">:</span><span class="w">
</span><span class="w">              </span>- ALL<span class="w">
</span><span class="w">              </span><span class="k">add</span><span class="p">:</span><span class="w">
</span><span class="w">              </span>- NET_BIND_SERVICE<span class="w">
</span><span class="w">        </span><span class="k">args</span><span class="p">:</span><span class="w">
</span><span class="w">         </span>- --port=<span class="m">31194</span><span class="w">
</span><span class="w">         </span>- --profiling<span class="w">
</span><span class="w">         </span>- --housekeeping_interval=1s<span class="w">
</span><span class="w">      </span><span class="k">automountServiceAccountToken</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="w">      </span><span class="k">terminationGracePeriodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span><span class="w">      </span><span class="k">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>rootfs<span class="w">
</span><span class="w">        </span><span class="k">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="k">path</span><span class="p">:</span><span class="w"> </span>/<span class="w">
</span><span class="w">      </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>var-run<span class="w">
</span><span class="w">        </span><span class="k">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="k">path</span><span class="p">:</span><span class="w"> </span>/var/run<span class="w">
</span><span class="w">      </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>sys<span class="w">
</span><span class="w">        </span><span class="k">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="k">path</span><span class="p">:</span><span class="w"> </span>/sys<span class="w">
</span><span class="w">      </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>docker<span class="w">
</span><span class="w">        </span><span class="k">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="k">path</span><span class="p">:</span><span class="w"> </span>/var/lib/docker<span class="w">
</span><span class="w">      </span>- <span class="k">name</span><span class="p">:</span><span class="w"> </span>disk<span class="w">
</span><span class="w">        </span><span class="k">hostPath</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="k">path</span><span class="p">:</span><span class="w"> </span>/dev/disk<span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ol>
<li>By executing <code>kubectl apply -k .</code> from within the new folder (<code>/tmp/monitoring-veba</code>), the daemonset will be deployed in a new namespace called <code>vrops</code>.</li>
</ol>
<h3 id="validate-the-cadvisor-deployment">Validate the cAdvisor deployment</h3>
<p>To ensure that our procedure was correct, we will check the deployment of the pod.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@veba040 <span class="o">[</span> /tmp/monitoring-veba <span class="o">]</span><span class="c1"># kubectl -n vrops get pods</span>
NAME             READY   STATUS    RESTARTS   AGE
cadvisor-ccgcx   1/1     Running   <span class="m">0</span>          4m
</code></pre></td></tr></table>
</div>
</div><p><code>STATUS Running</code> is the desired state which will fulfill our requirements to continue with the import of the vROps Management Pack for Container Monitoring as well as with the configuration of the Kubernetes Adapter which is available after a successful import.</p>
<hr>
<h2 id="a-dashboard-to-monitor-the-vmware-event-broker-appliance">A Dashboard to monitor the VMware Event Broker Appliance</h2>
<p>Before we continue with the configuration steps in vRealize Operations Manager, I wanted to give you a little sneak peek what you can expect by the end.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" data-sub-html="<h2>Figure III: vROps Dashboard to monitor VEBA</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" />
    </a><figcaption class="image-caption">Figure III: vROps Dashboard to monitor VEBA</figcaption>
    </figure>
<h3 id="step-1-import-vrops-management-pack-for-container-monitoring">Step 1. Import vROps Management Pack for Container Monitoring</h3>
<p>To enable the capability to monitor Kubernetes Clusters in vRealize Operations Manager, it&rsquo;s necessary to import a Management Pack for it, which is available for free at the <a href="https://marketplace.vmware.com" target="_blank" rel="noopener noreffer">VMware Marketplace</a>.</p>
<ol>
<li>Download the <a href="https://marketplace.vmware.com/vsx/solutions/vrealize-operations-management-pack-for-container-monitoring" target="_blank" rel="noopener noreffer">Mangement Pack for Container Monitoring</a></li>
<li>Import the Management Pack in vROps as follows:</li>
</ol>
<ul>
<li>Go to <code>Administration</code> -&gt; <code>Repository</code> and select <code>ADD/UPGRADE</code></li>
<li>Browse to the folder which contains the <code>vmware-MPforContainerMonitoring-1.4.3-15987816.pak</code> file for the Management Pack and upload it up to vROps
<ul>
<li>It will appear after the installation</li>
</ul>
</li>
<li>Configure the Kubernetes Adapter to establish a connection to your VEBA node(s)</li>
</ul>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">If you are running more then one VEBA node, than you have to repeat the next steps for each instance separately.</div>
        </div>
    </div>
<ul>
<li>Go to <code>Other Accounts</code> and select the <code>Kubernetes Adapter</code>
<ul>
<li>Enter the IP address of your VEBA instance followed by port 6443
<ul>
<li>e.g.<code>https://10.10.14.4:6443</code></li>
</ul>
</li>
<li>Select <code>DaemonSet</code> as your cAdvisor Service</li>
<li>Enter your specified <code>cAdvisor Port</code>
<ul>
<li><code>31194</code> was defined above</li>
</ul>
</li>
<li>Add new <code>Credentials</code> for your VEBA instance</li>
</ul>
</li>
</ul>
<p>We need to configure <code>Client Certificate Auth</code> as credential kind. To get the data for <code>Certificate Authority Data</code>, <code>Client Certificate Data</code> as well as for the <code>Client Key Data</code> we need to <code>ssh</code> again into our VEBA appliance. Execute the following to get the data:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">grep <span class="s1">&#39;client-certificate-data\|client-key-data\|certificate-authority-data&#39;</span> ~/.kube/config
</code></pre></td></tr></table>
</div>
</div><p>This is how the output should look like:</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg" data-sub-html="<h2>Figure IV: Client Certificate Auth data grep&rsquo;ed from kube config</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_084225.jpg" />
    </a><figcaption class="image-caption">Figure IV: Client Certificate Auth data grep&rsquo;ed from kube config</figcaption>
    </figure>
<p>Back in vROps, fill out the blank fields as required (Proxy only if needed).</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg" data-sub-html="<h2>Figure V: Client Certificate Auth Credentials config in vROps</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_082113.jpg" width="500" />
    </a><figcaption class="image-caption">Figure V: Client Certificate Auth Credentials config in vROps</figcaption>
    </figure>
<p>The last configuration at this point is to provide the FQDN of your vCenter Server under <code>Advanced Settings</code>. This will give us the possibility to include the virtual machine object itself and not only the Kubernetes components in the dashboard later on.</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg" data-sub-html="<h2>Figure VI: Account Information for VEBA</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_081807.jpg" />
    </a><figcaption class="image-caption">Figure VI: Account Information for VEBA</figcaption>
    </figure>
<div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>Attention<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><strong>Please do not</strong> forget to disable <code>ssh</code> again after finishing the above steps.</div>
        </div>
    </div>
<h3 id="step-2-preparations-for-the-dashboard">Step 2. Preparations for the dashboard</h3>
<p>Before we can import the dashboard and the corresponding views, we need to configure two simple steps first. The creation of a <code>Custom Metric Configuration</code> and a <code>Dynamic Custom Group</code>.</p>
<h4 id="veba-node-utilization-metric-configuration">VEBA Node Utilization Metric Configuration</h4>
<p>Go to <code>Administration</code> -&gt; <code>Configuration</code> -&gt; <code>Metric Configurations</code> -&gt; <code>ReskndMetric</code> and select <code>ADD</code>. Enter the name <code>veba_node_utilization</code> and paste the following configuration into the right opened field:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;AdapterKinds&gt;</span>
    <span class="nt">&lt;AdapterKind</span> <span class="na">adapterKindKey=</span><span class="s">&#34;KubernetesAdapter&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ResourceKind</span> <span class="na">resourceKindKey=</span><span class="s">&#34;K8S-Minion&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Metric</span> <span class="na">attrkey=</span><span class="s">&#34;Cpu|UsagePct|Total&#34;</span> <span class="na">label=</span><span class="s">&#34;CPU Usage Total&#34;</span> <span class="na">unit=</span><span class="s">&#34;%&#34;</span> <span class="na">yellow=</span><span class="s">&#34;80&#34;</span> <span class="na">orange=</span><span class="s">&#34;90&#34;</span> <span class="na">red=</span><span class="s">&#34;99&#34;</span> <span class="na">link=</span><span class="s">&#34;&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Metric</span> <span class="na">attrkey=</span><span class="s">&#34;Memory|UsagePct&#34;</span> <span class="na">label=</span><span class="s">&#34;Memory Usage&#34;</span> <span class="na">unit=</span><span class="s">&#34;%&#34;</span> <span class="na">yellow=</span><span class="s">&#34;80&#34;</span> <span class="na">orange=</span><span class="s">&#34;90&#34;</span> <span class="na">red=</span><span class="s">&#34;99&#34;</span> <span class="na">link=</span><span class="s">&#34;&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Metric</span> <span class="na">attrkey=</span><span class="s">&#34;Network|Interface:eth0|ReadMb&#34;</span> <span class="na">label=</span><span class="s">&#34;eth0 read&#34;</span> <span class="na">unit=</span><span class="s">&#34;KB&#34;</span> <span class="na">yellow=</span><span class="s">&#34;&#34;</span> <span class="na">orange=</span><span class="s">&#34;&#34;</span> <span class="na">red=</span><span class="s">&#34;&#34;</span> <span class="na">link=</span><span class="s">&#34;&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Metric</span> <span class="na">attrkey=</span><span class="s">&#34;Network|Interface:eth0|WriteMb&#34;</span> <span class="na">label=</span><span class="s">&#34;eth0 write&#34;</span> <span class="na">unit=</span><span class="s">&#34;KB&#34;</span> <span class="na">yellow=</span><span class="s">&#34;&#34;</span> <span class="na">orange=</span><span class="s">&#34;&#34;</span> <span class="na">red=</span><span class="s">&#34;&#34;</span> <span class="na">link=</span><span class="s">&#34;&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ResourceKind&gt;</span>
    <span class="nt">&lt;/AdapterKind&gt;</span>
<span class="nt">&lt;/AdapterKinds&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="veba-openfaas-fn-namespace-custom-group">VEBA openfaas-fn namespace Custom Group</h4>
<p>The dashboard includes a widget which will display all deployed functions and it&rsquo;s utilization in terms of CPU and Memory (limit, current, average and maximum).</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg" data-sub-html="<h2>Figure VII: vROps Widget to show function utilization</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_105442.jpg" />
    </a><figcaption class="image-caption">Figure VII: vROps Widget to show function utilization</figcaption>
    </figure>
<p>I configured a <code>Dynamic Custom Group</code> in vROps to realize this. Like the above step for the <code>VEBA Node Utilization Metric Configuration</code>, this Dynamic Custom Group has to be configured before we import the dashboard. Otherwise, the widget(s) will be empty.</p>
<p>Navigate to <code>Administration</code> -&gt; <code>Configuration</code> -&gt; and create a new <code>Group Type</code> called <code>VEBA</code>. The <code>Custom Group</code> can be configured under <code>Environment</code> -&gt; <code>Groups and Applications</code> -&gt; <code>Custom Group</code>. Select the before created Group Type VEBA and click <code>ADD</code>. Configure the Custom Group as shown in <em>Figure VIII</em>:</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg" data-sub-html="<h2>Figure VIII: Dynamic Custom Group for Æ’(x) in namespace openfaas-fn</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_091451.jpg" />
    </a><figcaption class="image-caption">Figure VIII: Dynamic Custom Group for Æ’(x) in namespace openfaas-fn</figcaption>
    </figure>
<h3 id="step-3-import-the-dashboard-and-its-views">Step 3. Import the Dashboard and it&rsquo;s Views</h3>
<h4 id="the-dashboard-is-available-for-download-on-vmware-codehttpscodevmwarecomsamplesid7241">The Dashboard is available for download on <a href="https://code.vmware.com/samples?id=7241" target="_blank" rel="noopener noreffer">VMware {code}</a></h4>
<p>Unpack the zip file and import the views first. <code>Dashboards</code> -&gt; select any of the views, click on <code>ACTIONS</code> and select <code>Manage Views</code>. The <code>Import</code> button will appear after clicking on the three points next to the <code>ADD</code> button. Go to the folder where you&rsquo;ve unpacked the <code>dashboard.zip</code> and select the <code>views.zip</code>. This will import the Views.</p>
<p>Similar procedure applies for the dashboard itself. <code>Dashboards</code> -&gt; <code>ACTIONS</code> -&gt; <code>Manage Dashboards</code> -&gt; three points -&gt; <code>Import</code> and this time, select the <code>dashboard.zip</code>.</p>
<p>Here we go!</p>
<figure class="center"><a class="lightgallery" href="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" title="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" data-thumbnail="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" data-sub-html="<h2>Figure IX: vROps Dashboard (again) to monitor VEBA</h2>">
        <img
            class="lazyload"
            src="/svg/loading/normal.min.svg"
            data-src="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg"
            data-srcset="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg, /img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg 1.5x, /img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg 2x"
            data-sizes="auto"
            alt="/img/posts/202005_vropsveba/CapturFiles-20200512_041624.jpg" />
    </a><figcaption class="image-caption">Figure IX: vROps Dashboard (again) to monitor VEBA</figcaption>
    </figure>
<hr>
<center>Thanks for reading.</center></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>The article was updated on 2020-05-13&nbsp;<a class="git-hash" href="https://github.com/rguske/commit/b2780a752ff599023f4991943225caee846ee33f" target="_blank" title="commit by Robert Guske(rguske@mware.com) b2780a752ff599023f4991943225caee846ee33f: finished new post on monitoring veba">
                                <i class="fas fa-hashtag fa-fw"></i>b2780a7</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager" data-via="vmw_rguske" data-hashtags="May2020,VEBA,Monitoring,vRealize Operations Manager,Dashboard"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Share on Xing" data-sharer="xing" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager"><i class="fab fa-xing fa-fw"></i></a><a href="javascript:void(0);" title="Share on Blogger" data-sharer="blogger" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager"><i class="fab fa-evernote fa-fw"></i></a><a href="javascript:void(0);" title="Share on Skype" data-sharer="skype" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager"><i class="fab fa-skype fa-fw"></i></a><a href="javascript:void(0);" title="Share on Trello" data-sharer="trello" data-url="https://rguske.github.io/post/monitoring-the-vmware-event-broker-appliance-with-vrealize-operations-manager/" data-title="Monitoring the VMware Event Broker Appliance with vRealize Operations Manager" data-description=""><i class="fab fa-trello fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/may2020/">May2020</a>,&nbsp;<a href="/tags/veba/">VEBA</a>,&nbsp;<a href="/tags/monitoring/">Monitoring</a>,&nbsp;<a href="/tags/vrealize-operations-manager/">vRealize Operations Manager</a>,&nbsp;<a href="/tags/dashboard/">Dashboard</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/post/tanzu-kubernetes-grid-integrated-edition-management-console-1-7/" class="prev" rel="prev" title="VMware Enterprise PKS got rebranded VMware Tanzu Kubernetes Grid Integrated Edition"><i class="fas fa-angle-left fa-fw"></i>VMware Enterprise PKS got rebranded VMware Tanzu Kubernetes Grid Integrated Edition</a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/about/" target="_blank">Robert Guske</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><style>.lg-toolbar .lg-icon::after { color: #999; }</style><script type="text/javascript">
    window.config = {"code":{"copyTitle":"Copy to clipboard","maxShownLines":80},"comment":{},"headerMode":{"desktop":"fixed","mobile":"auto"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};
</script><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=html5shiv%2CElement.prototype.closest%2CrequestAnimationFrame%2CCustomEvent%2CPromise%2CObject.entries%2CObject.assign%2CObject.values%2Cfetch%2CElement.prototype.after%2CArray.prototype.fill%2CIntersectionObserver%2CArray.from%2CArray.prototype.find%2CMath.sign"></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/object-fit-images/ofi.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
